<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>
    <h1>Cart</h1>
    <div id="cart-items"></div>
    <button><a href="checkout.html">checkout</a></button>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            function displayCart() {
                // Retrieve cart items from localStorage
                var cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];

                // Display cart items on the page
                var cartItemsContainer = document.getElementById("cart-items");
                cartItemsContainer.innerHTML = ""; // Clear existing content

                if (cartItems.length === 0) {
                    cartItemsContainer.innerHTML = "<p>Your cart is empty. <a href=\"index.html\">Continue Shopping</a></p>";
                } else {
                    var totalAmount = 0;

                    cartItems.forEach(function(item) {
                        var itemElement = document.createElement("div");
                        itemElement.innerHTML = `
                            <div>
                                <img src="${item.image}" alt="${item.name}" style="width: 100px;">
                                <p>Name: ${item.name}</p>
                                <p>Price: Rs ${item.price}</p>
                                <p>Quantity: ${item.quantity}</p>
                                <p>Size: ${item.buttonName}</p>
                                <button class="remove-item-button" data-name="${item.name}" data-price="${item.price}">Remove</button>
                                <hr>
                            </div>`;
                        cartItemsContainer.appendChild(itemElement);

                        // Calculate total amount
                        totalAmount += parseInt(item.price) * parseInt(item.quantity);
                    });

                    // Display total amount
                    cartItemsContainer.innerHTML += `<h3>Total: Rs ${totalAmount}</h3>`;

                    // Add event listeners to Remove buttons
                    var removeButtons = document.querySelectorAll(".remove-item-button");
                    removeButtons.forEach(function(button) {
                        button.addEventListener("click", function() {
                            var itemName = button.getAttribute("data-name");
                            var itemPrice = button.getAttribute("data-price");

                            // Retrieve cart items from localStorage
                            var cartItems = JSON.parse(localStorage.getItem("cartItems")) || [];

                            // Find index of item to remove
                            var index = cartItems.findIndex(function(item) {
                                return item.name === itemName && item.price === itemPrice;
                            });

                            // Decrease quantity by 1 or remove item if quantity is 1
                            if (index !== -1) {
                                if (cartItems[index].quantity > 1) {
                                    cartItems[index].quantity--;
                                } else {
                                    cartItems.splice(index, 1);
                                }
                                // Update cart items in localStorage
                                localStorage.setItem("cartItems", JSON.stringify(cartItems));
                                // Trigger live reload
                                displayCart();
                            }
                        });
                    });
                }
            }

            // Display cart initially
            displayCart();

            // Listen for changes in localStorage (storage event)
            window.addEventListener('storage', function(e) {
                // Check if the event is related to cartItems
                if (e.key === 'cartItems') {
                    // Trigger live reload
                    displayCart();
                }
            });
        });
    </script>
</body>
</html>
